# Meta-detector
This is an automatic security and privacy evaluation tool for Metaverse-related VR apps.
## Requirements
Python 3.7

Pytorch 1.8

Java 11

Dotnet core 3.1

## Static Analysis Configuration
The configuration refers to [covid-guardian](https://github.com/covid-guardian/covid-guardian).

Firstly, fill in the proper absolute path of android sdk in `staticanalyzer/config.yaml`
```text
sdk: 'path_to_android_sdk'
```
The configuration of IAP vulnerability and biometric data collection usage detection refers to [PaymentScope](https://github.com/OSUSecLab/PaymentScope).

Download PaymentScope repository and unzip PaymentScope folder.

The file `PaymentScope\src\ghidra_scripts` needs to be moved to `~/ghidra_scripts` for running which is required by Ghidra.

## Usage
command line 
```text
 $ python ./staticanalyzer/main.py APK_OR_DIRECTORY_PATH
```
## Result Analysis
The analysis results are generated in `results` file. Each app will be output in a `yaml` file. The general vulnerability statistics results can be attained from these `yaml` files.

The IAP vulnerability analysis and inconsistency biometric data collection function usage of IL2CPP-based apps can be executed by running `result_analysis.py`. As for the Mono-based apps, the result can be visualized from the decompiled codes generated by [dnSpy](https://github.com/dnSpy/dnSpy).

## Privacy Policy Analysis
1. Download the `HTML` file of the privacy policy from the app's homepage.

2. Use the following command line to transfer the `HTML` file to `txt` file.
```text
 $ python ./PolicyAnalysis/network-to-policy_consistency/Preprocessor.py --input ./ext/html_policies --outputdir ./ext/plaintext_policies
```

3.  Download the NLP model provided by the [original PolicyLint](https://github.com/benandow/PrivacyPolicyAnalysis) and extract the `tar.gz` file into ext/.

4. Use the following command line to use the NLP tool to generate `<entity, action, datatype>` stataments.
```text
 $ python ./PolicyAnalysis/network-to-policy_consistency/PatternExtractionNotebook.py ./ext
```
The process results are in `PolicyAnalysis/network-to-policy_consistency/ext/output`. Transfer the files in this path to JSON format and move the files to `results/policy`.

## Publication
This repository was proposed in the paper accepted by [ICSE'24](https://arxiv.org/abs/2402.13815), and we would really appreciate for your citation if this repo helps you.
```latex
@inproceedings{10.1145/3597503.3639082,
author = {Guo, Hanyang and Dai, Hong-Ning and Luo, Xiapu and Zheng, Zibin and Xu, Gengyang and He, Fengliang},
title = {An Empirical Study on Oculus Virtual Reality Applications: Security and Privacy Perspectives},
year = {2024},
isbn = {9798400702174},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3597503.3639082},
doi = {10.1145/3597503.3639082},
booktitle = {Proceedings of the IEEE/ACM 46th International Conference on Software Engineering},
articleno = {159},
numpages = {13},
keywords = {virtual reality, metaverse, static analysis, security and privacy},
location = {, Lisbon, Portugal, },
series = {ICSE '24}
}
```


